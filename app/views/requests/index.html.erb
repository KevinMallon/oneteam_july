
<% provide(:title, 'All requests') %>

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>jQuery UI Tabs - Default functionality</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<link href="/assets/custom.css?body=1" media="all" rel="stylesheet" type="text/css" />
<script>
$(function() {
$( "#tabs" ).tabs();
});
</script>
</head>

<body>
  
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Requests</a></li>
    <li><a href="#tabs-2">My Profile</a></li>
    <li><a href="#tabs-3">Requests I've Posted</a></li>
    </ul>

<div id="tabs-1">

    <h3>All Requests</h3>

    <ul class="employees">
  
    <% @requests.each do |request| %>
      <% if request.active == "1" %>  
      <% if request.employee != current_employee %> 
        <% if Date.today < request.stop_date %>

      <li>

        <p><b><%= request.project %>:</b> <%= request.start_date %> to <%= request.stop_date %> (Status: <%= request.progress_status %>) </br>
          Posted by: <%= request.employee.name %> in <%= request.employee.location %> Office (Group: <%= request.employee.group %>) </br>
          Description: <%= request.content %></br>
        </p> 

        <p>
          <% if request.applied_status(current_employee) == "applied" %>
               Applied
          <% else %>
               <%= link_to "Apply", new_request_response_path(request), class: "btn" %>
          <% end %>
        </p>

      </li>

        <% end %>
      <% end %>
      <% end %>
    <% end %>

</ul>    
</div>


<div id="tabs-2">
  <h3>
    My Profile
  </h3>

  <p class="employees">
    <%= link_to 'Edit Profile', edit_employee_path(@employee) =%>
  </p></br>
  
  <p>
    <%= gravatar_for @employee %>
  </p>

  <div class="offset2">
    <div class="employees">

    <p>
        Name:
        <%= @employee.name %>
    </p>

    <p>
        Email:
        <%= @employee.email %>
    </p>

    <p>
        Office:
        <%= @employee.location %>
    </p>

    <p>
        Department:
        <%= @employee.department %>
    </p>

    <p>
        Group:
        <%= @employee.group %>
    </p>

    <p>
        Job Title:
        <%= @employee.job_title %>
    </p>

    <p>
        Immediate Supervisor:
        <%= @employee.supervisor %>
    </p>

    <p>
        Years with Company:
        <%= @employee.years_at_company %>
    </p>

  <p>Current Skills:       
    <% @skillname = [] %>            
      <% @employee.employee_skills.each do |emp_skill| %>              
      <% show_skill(emp_skill) %>            
      <% end %>            
      <%= @skillname.join(", ") %>  
  </p>

  <p>Target Skills:
    <% @skillname = [] %>            
      <% @employee.target_skills.each do |targ_skill| %>              
      <% show_skill(targ_skill) %>            
      <% end %>            
      <%= @skillname.join(", ") %>  
  </p>

    <p>
        Short Description about <%= @employee.name %>:
        <%= @employee.description %>
    </p>

    <p>
      <b>Projects I've worked on:</b>
      <% if !@employee.selections.nil? %>
      <% @employee.selections.each do |selection| %>          
        <% if selection.employee_id == current_employee.id %>  
          <p>                      
              <%= selection.request.project %>:
              <%= selection.request.start_date %> to 
              <%= selection.request.stop_date %> 
              (<%= selection.request.progress_status %>)
              <%= selection.request.content %> 
          </p>
        <% end %>        
      <% end %>
      <% end %>
    </p>

  </div>
  </div>
</div>



<div id="tabs-3">
  <h3>Requests I've Posted</h3>

  <ul  class="employees"><li><%= link_to 'New Request', new_request_path %></li></ul>

  <% if !current_employee.requests.empty? %>

     <% @myrequests.each do |request| %> 

        <ul  class="employees">
          <li>
           <p>
              <b><%= request.project %>:</b>
              <%= request.start_date %> - <%= request.stop_date %></br>
               Description: <%= request.content %></br>
              <% if request.active == "1" %>
                Active  <%= link_to 'Edit or Cancel', edit_request_path(request) %></p>
              <% else %>
                <span class="cancelled">Cancelled</span>
              <% end %>              
          </p>

          <% if request.active == "1" %>
            <p>Applicants:</br>

            <% request.responses.each do |response| %>
            
              <% if !response.selections.empty? %>    
                       <%= link_to response.employee.name, employee_path(response.employee) %> Selected                                
              <% else %> 
                       <%= link_to response.employee.name, employee_path(response.employee) %> <%= link_to 'Select', new_response_selection_path(response) %>
              <% end %>
              </br>
            <% end %>
          <% end %>                       

         </li>
        </ul>
    <% end %>
  <% else %> 
    You have not posted any requests.

<% end %> 
</div>

</div>
</body>
</html>
